(function(){"use strict";angular.module("cortadoApp",[]).config(["$httpProvider",function(a){return a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]),_.kill_event=function(a){return a.cancelBubble=!0,a.stopPropagation(),a.preventDefault()},_.corsproxy=function(a){var b;return b=a.match(/https?:\/\/(.+)/),b?"http://www.corsproxy.com/"+b[1]:!1},_.position=function(a){var b;for(b={x:a.offsetLeft||0,y:a.offsetTop||0};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}}).call(this),function(){angular.module("cortadoApp").directive("aceEditor",function(){return{restrict:"A",require:"?ngModel",scope:!1,link:function(a,b,c,d){var e,f;return a.acee=e=window.ace.edit(b[0]),a.session=f=e.getSession(),a.mode=c.mode,e.setTheme("ace/theme/solarized_light"),e.getSession().setMode("ace/mode/"+a.mode),e.setOption("useWrapMode",!0),e.setOption("showGutter",!0),e.setReadOnly(!1),e.setHighlightActiveLine(!1),angular.isDefined(d)&&(d.$formatters.push(function(a){if(angular.isUndefined(a)||null===a)return"";if(angular.isObject(a)||angular.isArray(a))throw new Error("ace-editor cannot use an object or an array as a model");return a}),d.$render=function(){return f.setValue(d.$viewValue)}),f.on("change",function(){var b;return b=f.getValue(),b!==a.$eval(c.value)&&!a.$$phase&&angular.isDefined(d)?a.$apply(function(){return d.$setViewValue(b)}):void 0})},controller:["$scope","$rootScope",function(a,b){return b.$on("panel_resized",function(){return a.acee.resize()}),a.themes=["merbivore","merbivore_soft","mono_industrial","monokai","pastel_on_dark","solarized_dark","solarized_light","terminal","textmate","tomorrow","tomorrow_night","tomorrow_night_blue","tomorrow_night_eighties","twilight","vibrant_ink","xcode"],a.setTheme=function(b){return a.acee.setTheme("ace/theme/"+b)}}]}})}.call(this),function(){"use strict";var a;a="Literate CoffeeScript made awesomer!\n===\n\n**Literate CoffeeScript** is a [literate programming](http://en.wikipedia.org/wiki/Literate_programming)\napproach to writing [CoffeeScript](http://coffeescript.org).\nA .litcoffee file is a markdown file containing 4-space indented code blocks of \nCoffeeScript. When interpreted by the CoffeeScript compiler (>=1.5.0) the \nmarkdown is ignored and the code is compiled as if it were a normal `.coffee` \nfile.\n\n**Cortado** is an app for instantly previewing literate coffescript (or any markdown)\nas style HTML.\n\n    cortado = (file.litcoffee) ->\n      display with styled\n\nThe [Cortado](http://en.wikipedia.org/wiki/Cortado) is my favourite way of taking \ncoffee.\n\n    for sip in cortado\n      drink sip,\n        rate: \"slowly\"\n\n\n## Features\n\n* Embeded Ace Editors for Literate Coffeesript, and CSS themes\n* instant switching between themes\n* instant displaty the resulting html (both rendered with the css \ntheme and as html code)\n* load `.litcoffee`, `.md` and `.css` files drag'n'droping from the desktop into the \napp window\n",angular.module("cortadoApp").service("dndFile",["$rootScope",function(){var a,b,c,d=this;return a=/\.(md|litcoffee|css)$/,c=function(a,b){var c,e;return(c=function(){var c,d,e;for(d=0,e=a.length;e>d;d++)if(c=a[d],b.test(c.name))return c}())?(e=new FileReader,e.onload=function(a){return a.fileName=c.name.replace(b,""),a.fileExt=c.name.match(b)[1],d.callbacks.fileload(a)},e.readAsText(c)):void 0},b=function(a){var b;return b=a.dataTransfer.files,b.length?(c(b,/\.(md|litcoffee)$/),c(b,/\.(css)$/)):void 0},this.callbacks={active:function(){},inactive:function(){},fileload:function(){},drop:function(){},default_drop:b},{init:function(a){return a.addEventListener("dragenter",function(a){return _.kill_event(a),d.callbacks.active(a)}),a.addEventListener("dragover",function(a){return _.kill_event(a),d.callbacks.active(a)}),a.addEventListener("dragexit",function(a){return _.kill_event(a),d.callbacks.inactive(a)}),a.addEventListener("drop",function(a){return _.kill_event(a),d.callbacks.drop(a),d.callbacks.default_drop(a)})},onactive:function(a){return d.callbacks.active=a},oninactive:function(a){return d.callbacks.inactive=a},onfileload:function(a){return d.callbacks.fileload=a},ondrop:function(a,c){return d.callbacks.drop=a,d.callbacks.default_drop=c?function(){}:b}}}]).controller("cortadoCtrl",["$scope","$http","$filter","$element","dndFile",function(b,c,d,e,f){return b.litcoffee=a,f.init(e[0],f.onactive(function(){return b.$apply(function(){return b.dragover=!0})})),f.oninactive(function(){return b.$apply(function(){return b.dragover=!1})}),e[0].addEventListener("mousemove",function(){return b.$apply(function(){return b.dragover=!1})}),f.ondrop(function(){return b.$apply(function(){return b.dragover=!1})},!1),f.onfileload(function(a){return b.$apply(function(){var c,d,e;if("md"===(e=a.fileExt)||"litcoffee"===e)return b.litcoffee=a.target.result;if("css"===a.fileExt){for(d=a.fileName,c=0;d in b.style.sheets;)d=""+a.fileName+" "+ ++c;return b.style.sheets[d]={source:"dragged file","native":!1,css:a.target.result},b.style.active=d}})}),b.style={active:"GitHub",sheets:{markdowncss:{source:_.corsproxy("http://kevinburke.bitbucket.org/markdowncss/markdown.css"),"native":!0},GitHub:{source:"styles/md/github.css","native":!0}},external:"",editor:""},b.copy_style=function(a,c){var d,e,f;for(_.kill_event(a),d=_.clone(b.style.sheets[c]),c=c.match(/(.*?)(:? copy(:? \d+)?)?$/)[1],f=""+c+" copy",e=0;f in b.style.sheets;)f=""+c+" copy "+ ++e;return d["native"]=!1,b.style.sheets[f]=d,b.style.active=f},b.delete_style=function(a,c){return _.kill_event(a),delete b.style.sheets[c],b.style.active===c?b.style.active=Object.keys(b.style.sheets)[0]:void 0},b.$watch("style.active",function(){var a;return b.style.active in b.style.sheets?(a=b.style.sheets[b.style.active],a.css?b.style.editor=d("prettifyCSS")(d("deSassify")(a.css)):c.get(a.source).then(function(c){return a.css=c.data,b.style.editor=d("prettifyCSS")(d("deSassify")(a.css))})):void 0}),b.$watch("style.editor",function(){return b.style.sheets[b.style.active].css=b.style.editor}),b.$watch("style.external",function(){return b.style.external&&/^(https?:\/\/)?(\w+\.)+[\w\/]+/.test(b.style.external)?c.get(_.corsproxy(b.style.external)).then(function(a){var c,d,e;for(d=0,c=b.style.external.match(/.+?\/(\w+)\.css/),e=c&&c[1]||"external";e in b.style.sheets;)e="external "+ ++d;return b.style.sheets[e]={source:b.style.external,css:a.data,external:!0,edited:!1},b.style.active=e,b.style.external=""}):void 0})}]).directive("menu",["$compile","$rootScope",function(a,b){return{scope:!0,restrict:"C",controller:["$scope",function(a){return a.menuitems||(a.menuitems={show:!1}),a.$on("bg_click",function(){return a.$apply(function(){return a.menuitems.show=!1})})}],link:function(c,d){var e;return d.children(".menu-title").bind("click",function(a){var d;return _.kill_event(a),d=!c.menuitems.show,b.$broadcast("bg_click"),c.$apply(function(){return c.menuitems.show=d})}),e=d.children(".menu-items"),e.attr("ng-class","{in:menuitems.show}"),e.bind("click",_.kill_event),a(e)(c)}}}])}.call(this),function(){angular.module("cortadoApp").directive("splitRow",function(){return{restrict:"E",transclude:!0,scope:{},replace:!0,template:'<div class="split-row" ng-transclude></div>',controller:["$scope","$element","$compile","$rootScope",function(a,b,c,d){var e,f,g,h=this;return a.row=b[0],f=a.$parent.cols=[],a.$parent.col=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=f.length;d>c;c++)b=f[c],b.name===a&&e.push(b);return e}()[0]},e=document.getElementsByTagName("body")[0],e.addEventListener("click",function(){return d.$broadcast("bg_click")}),$(document).keyup(function(a){return 27===a.keyCode?d.$broadcast("bg_click"):void 0}),this.equalCols=function(a){var b,c,d,e,g;for(a||(a=function(){var a,c,d;for(d=[],a=0,c=f.length;c>a;a++)b=f[a],b.show&&d.push(b);return d}().length),c=1/a,g=[],d=0,e=f.length;e>d;d++)b=f[d],b.show?g.push(b.ratio=c):g.push(b.ratio=0);return g},this.findLastCol=function(){var a,b,c,d;if(f.length){for(b=null,c=0,d=f.length;d>c;c++)a=f[c],a.last_shown=!1,a.show&&(b=a);return b?b.last_shown=!0:void 0}},this.addCol=function(b){var d=this;return a.$apply(function(){return b.index=f.length,f.push(b),d.equalCols(),b.div.append(c('<drag-area ng-show="!last_shown"></drag-area>')(b))})},window.r=a.row,g=function(b){return a.$apply(function(){var c,e,g,i,j;for(e=a.dragging,c=f[j=e.index+1];!c.show;)c=f[++j];return i=function(){var a,b,c;for(c=[],a=0,b=f.length;b>a;a++)g=f[a],g.index<e.index&&c.push(g.ratio);return c}().reduce(function(a,b){return a+b},0),e.ratio=(b-a.row.offsetLeft)/h.row_width-i,e.ratio<.1&&(e.ratio=.1),c.ratio=1-function(){var a;a=[];for(j in f)parseInt(j)!==c.index&&a.push(f[j].ratio);return a}().reduce(function(a,b){return a+b},0),c.ratio<.1&&(c.ratio=.1,e.ratio=1-function(){var a;a=[];for(j in f)parseInt(j)!==e.index&&a.push(f[j].ratio);return a}().reduce(function(a,b){return a+b},0)),e.div[0].onresize&&e.div[0].onresize(),c.div[0].onresize&&c.div[0].onresize(),d.$broadcast("panel_resized")})},(a.row.onresize=function(){return h.row_width=a.row.offsetWidth})(),this.start_drag=function(b,c){return _.kill_event(c),a.dragging=b},document.onmousemove=function(b){return _.kill_event(b),a.dragging&&g(b.clientX),b.caughtBy?void 0:d.$broadcast("mousemoved")},document.onmouseup=function(){return a.dragging=null}}]}}).directive("resizablePanel",["$rootScope",function(a){return{require:"^splitRow",restrict:"E",transclude:!0,scope:{name:"@",show:"@"},replace:!0,template:'<div class="resizable-panel" ng-transclude ng-style="{width: \'\'+(ratio*100)+\'%\'}" ng-show="show"></div>',controller:["$scope","$rootScope",function(a,b){return a.$watch("show",function(){return a.show=!!a.show,a.ctrl.equalCols(),a.ctrl.findLastCol(),setTimeout(function(){return b.$broadcast("panel_resized")})})}],link:function(b,c,d,e){return b.div=c,b.ctrl=e,b.mouseover=!1,setTimeout(function(){return b.show=!!b.show,e.addCol(b)},0),c.bind("mousemove",function(c){return c.originalEvent.caughtBy=b.name,b.mouseover?void 0:a.$broadcast("mousemoved",b.name)}),b.$on("mousemoved",function(a,c){return b.$apply(function(){return b.mouseover=c===b.name})})}}}]).directive("dragArea",function(){return{restrict:"E",replace:!0,template:'<div class="drag-area"></div>',scope:!1,link:function(a,b){return b.bind("mousedown",function(b){return a.ctrl.start_drag(a,b)})}}})}.call(this),function(){angular.module("cortadoApp").directive("renderPanel",["$compile",function(a){return{restrict:"A",replace:!0,template:'<div class="render-panel"></div>',scope:!0,link:function(b,c,d){return b.$watch(d.renderPanel,function(d){var e;return e=d&&d.replace(/\s*/,"")?markdown.toHTML(d):"",c.html(a(e)(b)),prettyPrint()})}}}]).directive("prettyPrintPanel",["$filter",function(a){return{restrict:"A",replace:!0,template:'<div class="pp-panel"></div>',scope:!0,link:function(b,c,d){return b.$watch(d.prettyPrintPanel,function(b){var d,e;return e=b&&b.replace(/\s*/,"")?markdown.toHTML(b):"",d=angular.element('<pre class="prettyprint lang-html"></pre>'),b=angular.element("<code></code>"),b.html(a("escapeHTML")(e)),d.append(b),c.html(d),prettyPrint()})},controller:["$scope","$http",function(a,b){var c;return a.$parent.theme=c={list:["google-code-light","solarized-dark","solarized-light","sons-of-obsidian-dark","tomorrow-night-blue","tomorrow-night-dark","tomorrow-night-light","tomorrow-night-eighties"],selected:"google-code-light"},a.$watch("theme.selected",function(a){var d;return d="styles/gprettify/"+a+".css",b.get(d).then(function(a){return c.css=a.data})})}]}}])}.call(this),function(){"use strict";angular.module("cortadoApp").filter("md2html",["$interpolate","$rootScope",function(){return function(a){return a&&a.replace(/\s*/,"")?markdown.toHTML(a):""}}]).filter("escapeHTML",["$interpolate","$rootScope",function(){return function(a){return a&&a.replace(/\s*/,"")?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}}]).filter("scopeCSS",["$filter",function(){return function(a,b){var c,d,e,f,g;return d=document.implementation.createHTMLDocument(""),g=document.createElement("style"),g.innerText=a,d.body.appendChild(g),c=/(^| )(head|title|link|style|script)($| )/,e="",f=function(d){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;if(d.length){for(D=[],i=v=0,A=d.length;A>=0?A>v:v>A;i=A>=0?++v:--v)if(d[i].selectorText)if(r=d[i].selectorText.split(", "),q=function(){var a,d,e;for(e=[],a=0,d=r.length;d>a;a++)p=r[a],c.test(p)||e.push(/(^| )(body|html)($| )/.test(p)?p.replace(/(body|html)/,b):""+b+" "+p);return e}().join(", ")){if(h="",/url\(\)/.test(d[i].cssText)){l=0;for(o in d)d[o].selectorText===d[i].selectorText&&parseInt(o)<i&&(l+=1);for(s=RegExp(d[i].selectorText+"\\s*{"),g=a.split(s)[l+1].split("}")[0],n={},B=g.match(/\s*(.+?)\s*:.+?url\((.+?)\).*?;/g),w=0,y=B.length;y>w;w++)j=B[w],k=j.match(/\s*([\-\w]+)\s*:.+?url\((.+?)\).*?;/),u=k[1].replace(/\s+/g,""),t=k[2].replace(/\s+/g,""),n[u]=t;for(h+=q+" { ",C=d[i].cssText.match(/\{(.+)\}/)[1].split(";"),x=0,z=C.length;z>x;x++)m=C[x],~m.indexOf("url()")?(u=m.match(/\s*(.+?)\s*:.+/)[1].replace(/\s+/g,""),t=n[u],t||"background-image"===u&&(t=n.background),m=m.replace("url()","url("+t+")"),h+=m+"; "):h+=m+"; ";h+=" } "}else d[i].selectorText=q,h=d[i].cssText;D.push(e+=h+"   ")}else D.push(void 0);else"screen"===d[i].media[0]?D.push(f(d[i].cssRules)):D.push(void 0);return D}},f(g.sheet.cssRules),e}}]).filter("deSassify",function(){return function(a){return a.replace(/@media -sass-debug-info.*?\{(?:.*?\{.*?\})+.*?\}/g,"")}}).filter("prettifyCSS",function(){return function(a){return a.replace(/^\s+/g,"").replace(/\s*,\s*/g,", ").replace(/\s*{\s*/g," {\n    ").replace(/\s*;\s*/g,";\n    ").replace(/\*\//g,"*/\n").replace(/\n\n+/g,"\n").replace(/\s*}\s*/g,"\n}\n\n")}}).filter("prettifyHTML",function(){var a,b,c,d,e;return c=function(a,b){return 0>=a?"":Array(a-b+1).join("  ")},d=function(a){return"span"===a||"a"===a||"code"===a||"i"===a||"b"===a||"em"===a||"strong"===a||"abbr"===a||"img"===a||"h1"===a||"h2"===a||"h3"===a||"h4"===a||"h5"===a||"h6"===a||"bdi"===a||"bdo"===a||"wbr"===a||"kbd"===a||"del"===a||"ins"===a||"s"===a||"rt"===a||"rp"===a||"var"===a||"time"===a||"sub"===a||"sup"===a||"link"===a||"title"===a||"label"===a||"input"===a},a=function(a){return"area"===a||"br"===a||"col"===a||"embed"===a||"hr"===a||"img"===a||"input"===a||"keygen"===a||"link"===a||"meta"===a||"base"===a||"param"===a||"source"===a||"track"===a||"wbr"===a},b=function(a){var b;return function(){var c,e,f;for(f=[],c=0,e=a.length;e>c;c++)b=a[c],d(b)&&f.push(b);return f}().length},e="<(?:(?:(\\w+)[^><]*?)|(?:\\/(\\w+)))>",e=new RegExp(e),e.compile(e),function(f){var g,h,i,j,k,l,m,n;for(l=f,h=0,m=[],k="";f;)g=f.search(e),g+1||(k+=f,f=""),j=f.match(e),(n=j[1])?d(n)?("\n"===k.charAt(k.length-1)&&(k+=c(m.length,h)),k+=f.substr(0,g+j[0].length),m.push(n),h+=1,f=f.substr(g+j[0].length)):a(n)?("\n"===k.charAt(k.length-1)&&(k+=c(m.length,h)),k+=f.substr(0,g+j[0].length),f=f.substr(g+j[0].length)):(g&&"\n"===k.charAt(k.length-1)&&(k+=c(m.length,h)),k+=""+f.substr(0,g),"\n"!==k.charAt(k.length-1)&&(k+="\n"),k+=c(m.length,h)+j[0],m.push(n),k+="\n",f=f.substr(g+j[0].length)):(n=j[2])?(i=m.lastIndexOf(n),i+1?d(n)?(h-=1,m.splice(i),k+=""+f.substr(0,g)+j[0],f=f.substr(g+j[0].length)):(g&&"\n"===k.charAt(k.length-1)&&(k+=c(m.length,h)),m.splice(i),h=b(m),k+=""+f.substr(0,g)+("\n"===k.charAt(k.length-1)?"":"\n")+c(m.length,h)+j[0],f=f.substr(g+j[0].length),"\n"!==f[0]&&(k+="\n")):(k+=""+f.substr(0,g+j[0].length),f=f.substr(g+j[0].length))):console.warn("UH OH: found a tag that's not an opening tag or a closing tag!?!?");return k}})}.call(this);